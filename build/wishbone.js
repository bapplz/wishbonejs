(function(){this.EventDispatcher=function(){function a(a,b,c){this.eventReceiver=a,this.routes=b,this.instanceBuilder=c,this.readyToDispatch=!0}return a.prototype.start=function(){return this.eventReceiver.on("afterEventReceived",this.onDispatchEvent.bind(this))},a.prototype.onDispatchEvent=function(a){if(this.readyToDispatch===!0)return this.fireNextEvent()},a.prototype.fireNextEvent=function(){var a,b,c,d,e;b=this.eventReceiver.poll();if(b===null)return;return this.readyToDispatch=!1,d=this.routes.getHandler(b.type).name,a=NameExtractor.extract(d),e=a+"View",c=this.instanceBuilder.build(d,e),c.on("eventHandled",this.onEventHandled.bind(this)),c.present()},a.prototype.onEventHandled=function(a){return this.readyToDispatch=!0,this.fireNextEvent()},a}()}).call(this),function(){var a={}.hasOwnProperty,b=function(b,c){function e(){this.constructor=b}for(var d in c)a.call(c,d)&&(b[d]=c[d]);return e.prototype=c.prototype,b.prototype=new e,b.__super__=c.prototype,b};this.Publisher=function(){function a(){this.callbacks=[],this.addCallbackSlots()}return a.prototype.addCallbackSlots=function(){return console.log("logger")},a.prototype.on=function(a,b){return this.initCallbacksKey(a),this.callbacks[a].push(b)},a.prototype.trigger=function(a,b){var c,d,e,f,g;d=this.callbacks[a],g=[];for(e=0,f=d.length;e<f;e++)c=d[e],g.push(c(b));return g},a.prototype.initCallbacksKey=function(a){if(this.callbacks[a]===void 0)return this.callbacks[a]=[]},a}(),this.EventReceiver=function(a){function c(){this.events=[],c.__super__.constructor.apply(this,arguments)}return b(c,a),c.prototype.addCallbackSlots=function(){return this.initCallbacksKey("beforeEventReceived"),this.initCallbacksKey("afterEventReceived"),this.initCallbacksKey("beforeEventRemoved")},c.prototype.receive=function(a){var b;return b=new Object,b.type=a.type,this.trigger("beforeEventReceived",b),this.initCallbacksKey(a.type),this.events.push(a),this.trigger("afterEventReceived",b)},c.prototype.poll=function(){var a,b;return b=this.events[0],b===void 0?b=null:(a=new Object,a.type=b.type,this.trigger("beforeEventRemoved",a)),this.events.splice(0,1),b},c}(Publisher)}.call(this),function(){var a=[].slice;this.InstanceBuilder=function(){function b(){}return b.prototype.build=function(){var b,c,d;return b=arguments[0],c=2<=arguments.length?a.call(arguments,1):[],d=b,new window[d](c)},b}()}.call(this),function(){this.NameExtractor=function(){function a(){}return a.extract=function(a){var b;return a===""?a:(b=a.search(/\S[A-Z]\S/)+1,a.slice(0,b))},a}()}.call(this),function(){this.Publisher=function(){function a(){this.callbacks=[],this.addCallbackSlots()}return a.prototype.addCallbackSlots=function(){return console.log("logger")},a.prototype.on=function(a,b){return this.initCallbacksKey(a),this.callbacks[a].push(b)},a.prototype.trigger=function(a,b){var c,d,e,f,g;d=this.callbacks[a],g=[];for(e=0,f=d.length;e<f;e++)c=d[e],g.push(c(b));return g},a.prototype.initCallbacksKey=function(a){if(this.callbacks[a]===void 0)return this.callbacks[a]=[]},a}()}.call(this),function(){var a={}.hasOwnProperty,b=function(b,c){function e(){this.constructor=b}for(var d in c)a.call(c,d)&&(b[d]=c[d]);return e.prototype=c.prototype,b.prototype=new e,b.__super__=c.prototype,b};this.Publisher=function(){function a(){this.callbacks=[],this.createCallbackSlots()}return a.prototype.createCallbackSlots=function(){},a.prototype.on=function(a,b){return this.addCallbackSlots(a),this.callbacks[a].push(b)},a.prototype.trigger=function(a,b){var c,d,e,f,g;d=this.callbacks[a],g=[];for(e=0,f=d.length;e<f;e++)c=d[e],g.push(c(b));return g},a.prototype.addCallbackSlots=function(a){return this.callbacks[a]=[]},a}(),this.EventReceiver=function(a){function c(){this.events=[],c.__super__.constructor.apply(this,arguments)}return b(c,a),c.prototype.createCallbackSlots=function(){return this.addCallbackSlots("beforeEventReceived"),this.addCallbackSlots("afterEventReceived"),this.addCallbackSlots("beforeEventRemoved")},c.prototype.receive=function(a){var b;return b=new Object,b.type=a.type,this.trigger("beforeEventReceived",b),this.events.push(a),this.trigger("afterEventReceived",b)},c.prototype.poll=function(){var a,b;return b=this.events[0],b===void 0?b=null:(a=new Object,a.type=b.type,this.trigger("beforeEventRemoved",a)),this.events.splice(0,1),b},c}(Publisher),this.BasePresenter=function(a){function c(){return c.__super__.constructor.apply(this,arguments)}return b(c,a),c.prototype.createCallbackSlots=function(){return this.addCallbackSlots("eventHandled")},c.prototype.done=function(){var a;return a=new Object,a.type="eventHandled",this.trigger("eventHandled",a)},c}(Publisher)}.call(this),function(){this.Routes=function(){function a(){this.routes=[]}return a.prototype.add=function(a,b){return this.routes[a]=b},a.prototype.getHandler=function(a){return this.routes[a]},a}()}.call(this);